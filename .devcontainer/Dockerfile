FROM mcr.microsoft.com/vscode/devcontainers/javascript-node:0-20\n\nARG USERNAME=vscode\n\n# Install X server, window manager, VNC and tools\nRUN apt-get update \n  && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \n    xvfb \n    fluxbox \n    x11vnc \n    wget \n    git \n    python3 \n    python3-pip \n    net-tools \n    ca-certificates \n  && pip3 install --no-cache-dir websockify \n  && git clone https://github.com/novnc/noVNC.git /opt/noVNC \n  && chmod -R a+rx /opt/noVNC \n  && rm -rf /var/lib/apt/lists/*\n\n# Copy helper script\nCOPY .devcontainer/run-vnc.sh /usr/local/bin/run-vnc.sh\nRUN chmod +x /usr/local/bin/run-vnc.sh\n\n# Create workspace dir and switch to non-root user\nRUN mkdir -p /workspace && chown -R ${USERNAME}:${USERNAME} /workspace\nUSER ${USERNAME}\nWORKDIR /workspace\nENV DISPLAY=:1\n\n# Keep container running; the VNC server will be started from postCreateCommand\nCMD ["sleep", "infinity"]